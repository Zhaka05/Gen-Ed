{#
SPDX-FileCopyrightText: 2023 Mark Liffiton <liffiton@gmail.com>

SPDX-License-Identifier: AGPL-3.0-only
#}

{% extends "base.html" %}
{% from "tables.html" import datatable, datatable_extrahead %}

{% block extrahead %}
{{ datatable_extrahead }}
{% endblock %}

{% block second_nav %}
<nav class="navbar is-light is-size-5" role="navigation" aria-label="admin navigation" x-data="{admin_menu_open: false}">
  <div class="navbar-brand">
    <a class="navbar-item has-text-danger is-tab {{ 'is-active' if request.endpoint == 'admin.admin_main.main' else ''}}" href="{{url_for('admin.admin_main.main')}}">
      <span class="icon">
        <svg aria-hidden="true"><use href="#svg_admin" /></svg>
      </span>
      <span>Admin</span>
    </a>
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" x-bind:class="admin_menu_open ? 'is-active' : ''" x-on:click="admin_menu_open = ! admin_menu_open">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu" x-bind:class="admin_menu_open ? 'is-active' : ''">
    <div class="navbar-start">
      {% for link in admin_links %}
        <a class="navbar-item is-tab {{ 'is-active' if request.endpoint == link.endpoint else ''}}" href="{{url_for(link.endpoint)}}">{{link.display}}</a>
      {% endfor %}
    </div>
    <div class="navbar-end">
      {% for link in admin_links_right %}
        <a class="navbar-item is-tab {{ 'is-active' if request.endpoint == link.endpoint else ''}}" href="{{url_for(link.endpoint)}}">
          {{link.display}}
          {% if link.endpoint == 'admin.get_db_file' %}
            <span class="ml-2 icon-text px-1 {% if db_download_status.encrypted %}has-text-success-dark{% else %}tag is-warning{% endif %}"
                title="{% if db_download_status.encrypted %}Download will be encrypted{% else %}{{db_download_status.reason}}{% endif %}"
                >
              <span class="icon">
                <svg aria-hidden="true" style="height: 80%;">
                  <use href="{% if db_download_status.encrypted %}#svg_admin_check{% else %}#svg_admin_alert{% endif %}" />
                </svg>
              </span>
              {% if not db_download_status.encrypted %}
                <span class="text" style="margin-left: -0.5em;">&nbsp;&nbsp;unencrypted</span>
              {% endif %}
            </span>
          {% endif %}
        </a>
      {% endfor %}
    </div>
  </div>
</nav>
{% endblock %}

{% block body %}
<section class="section pt-3 pb-4 pl-5 pr-5">
  {% block admin_body %}
  {% endblock %}
</section>
{% endblock %}
